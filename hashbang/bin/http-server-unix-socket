#!/usr/bin/python3
import sys
import socket

from socketserver import TCPServer
from http.server import HTTPServer, SimpleHTTPRequestHandler


class UnixHTTPServer(HTTPServer):
    address_family = socket.AF_UNIX

    def server_bind(self):
        TCPServer.server_bind(self)
        self.server_name = "localhost"
        self.server_port = 0

    def get_request(self):
        request, client_addr = super(UnixHTTPServer, self).get_request()
        return (request, ["localhost", 0])


server = UnixHTTPServer(sys.argv[-1], SimpleHTTPRequestHandler)
server.serve_forever()
